//http://maps.googleapis.com/maps/api/geocode/json?latlng=40.714224,-73.961452&sensor=false
define(["app/control/appControl","dojo/request","dojo/cookie","dojo/topic"],function(e,t,n,r){var i={_detectLocation:function(){function i(){function o(i){console.log("position",i);var o=i.coords.latitude,u=i.coords.longitude,a=new google.maps.LatLng(o,u);s.geocode({latLng:a},function(i,s){if(s===google.maps.GeocoderStatus.OK){e.location=t._getLocationString(i[1]);n("location",e.location);r.publish("updateLocation",e.location)}else r.publish("updateLocation",!1)})}function u(e){r.publish("updateLocation",!1)}var i={},s=new google.maps.Geocoder;navigator.geolocation?navigator.geolocation.getCurrentPosition(o,u):r.publish("updateLocation",!1)}var t=this;google.load("maps","3.x",{other_params:"sensor=false",callback:i})},setLocation:function(){e.location?r.publish("updateLocation",e.location):this._detectLocation()},_getLocationString:function(e){var t,n,r,i;e.address_components.forEach(function(e,s){console.log("type",e.types,e.long_name);var o=e.types;console.log("test",o);if(o[0]==="locality"){cityCode=s;console.log("city",e);t=e.long_name}o[0]==="administrative_area_level_1"&&(r=e.short_name);if(o[0]==="country"){n=e.long_name;i=e.short_name}});var s="";r&&n==="United States"||n==="Canada"?s=t+", "+r:s=t+", "+n;console.log("location",s);return s}};return i});